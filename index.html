<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Procesador de Excel</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>Procesador de CSV</h1>
        <div class="upload-section">
            <div class="upload-group">
                <label for="dataFile">Archivo de Datos (CSV):</label>
                <input type="file" id="dataFile" accept=".csv" required>
                <span class="file-info" id="dataFileInfo"></span>
            </div>
            
            <div class="template-info">
                <p><strong>Template:</strong> Se usar√° autom√°ticamente el archivo <code>trailer-template.csv</code> de la carpeta assets</p>
            </div>
        </div>

        <div class="options-section">
            <h3>Opciones de Conversi√≥n</h3>
            <div class="checkbox-group">
                <label>
                    <input type="checkbox" id="convertFtToIn" checked>
                    Convertir pies (ft) a pulgadas (in)
                </label>
            </div>
            
            <h4>Modo de Mapeo de Columnas</h4>
            <div class="radio-group">
                <label>
                    <input type="radio" id="useColumns" name="mappingMode" value="columns" checked>
                    Usar letras de columnas (A, B, C...)
                </label>
                <label>
                    <input type="radio" id="useHeaders" name="mappingMode" value="headers">
                    Usar headers (primera fila como referencia)
                </label>
            </div>
        </div>

        <div class="process-section">
            <button id="processBtn" class="process-btn" disabled>Procesar Archivos</button>
        </div>

        <div class="status-section">
            <div id="status" class="status"></div>
            <div id="progress" class="progress" style="display: none;">
                <div class="progress-bar"></div>
            </div>
        </div>

        <div class="download-section" id="downloadSection" style="display: none;">
            <button id="downloadBtn" class="download-btn">Descargar Excel Procesado</button>
        </div>

        <!-- Manual de Usuario -->
        <div class="user-manual-section">
            <div class="manual-header" onclick="toggleUserManual()">
                <h3>üìñ Manual de Usuario</h3>
                <span class="toggle-icon" id="manualToggleIcon">‚ñº</span>
            </div>
            <div class="manual-content" id="manualContent">
                <div class="manual-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h4>üìÅ Selecciona tu archivo CSV</h4>
                        <p>Haz clic en "Elegir archivo" y selecciona el archivo CSV con los datos que quieres procesar.</p>
                        <div class="step-visual">
                            <div class="visual-file-input">
                                <span>üìÑ Archivo de Datos (CSV): </span>
                                <button class="visual-btn">Elegir archivo</button>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="manual-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h4>‚öôÔ∏è Configura las opciones</h4>
                        <p>Selecciona las opciones de conversi√≥n seg√∫n tus necesidades:</p>
                        
                        <div class="option-explanation">
                            <h5>üîß Conversi√≥n de Unidades:</h5>
                            <p><strong>Convertir pies (ft) a pulgadas (in):</strong> Si tu archivo contiene medidas en pies (como "6.5 ft"), el sistema las convertir√° autom√°ticamente a pulgadas (como "78 in"). √ötil cuando tu archivo de datos usa pies pero necesitas el resultado en pulgadas.</p>
                        </div>

                        <div class="option-explanation">
                            <h5>üìä Modo de Mapeo de Columnas:</h5>
                            <p><strong>Usar letras de columnas (A, B, C...):</strong> El sistema buscar√° los datos en posiciones fijas. Por ejemplo, siempre tomar√° el dato de la columna A para el n√∫mero de stock, sin importar qu√© dice el encabezado.</p>
                            <p><strong>Usar headers (primera fila como referencia):</strong> El sistema leer√° los nombres de las columnas en la primera fila y buscar√° por nombre. Por ejemplo, buscar√° una columna que se llame "stock #" sin importar en qu√© posici√≥n est√©.</p>
                        </div>
                        
                        <div class="step-visual">
                            <div class="visual-options">
                                <label class="visual-checkbox">
                                    <input type="checkbox" checked disabled>
                                    <span>‚úÖ Convertir pies (ft) a pulgadas (in)</span>
                                </label>
                                <div class="visual-radio-group">
                                    <label class="visual-radio">
                                        <input type="radio" name="demo" checked disabled>
                                        <span>üî§ Usar letras de columnas (A, B, C...)</span>
                                    </label>
                                    <label class="visual-radio">
                                        <input type="radio" name="demo" disabled>
                                        <span>üìã Usar headers (primera fila como referencia)</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="manual-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h4>üîÑ Procesa los archivos</h4>
                        <p>Una vez que hayas seleccionado tu archivo, el bot√≥n "Procesar Archivos" se activar√°. Haz clic para iniciar el procesamiento.</p>
                        <div class="step-visual">
                            <button class="visual-process-btn">üîÑ Procesar Archivos</button>
                        </div>
                    </div>
                </div>

                <div class="manual-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h4>‚¨áÔ∏è Descarga el resultado</h4>
                        <p>Cuando el procesamiento termine, aparecer√° un bot√≥n para descargar tu archivo Excel procesado.</p>
                        <div class="step-visual">
                            <button class="visual-download-btn">üì• Descargar Excel Procesado</button>
                        </div>
                    </div>
                </div>

                <div class="manual-tips">
                    <h4>üí° Consejos √∫tiles:</h4>
                    <ul>
                        <li><strong>Template autom√°tico:</strong> El sistema usa autom√°ticamente el template <code>trailer-template.csv</code></li>
                        <li><strong>Conversi√≥n de unidades:</strong> Solo se aplica a campos de medidas (largo, ancho, alto). Si no tienes medidas en pies, puedes desactivar esta opci√≥n</li>
                        <li><strong>Modo columnas vs headers:</strong> 
                            <ul>
                                <li>Usa <em>columnas</em> si tu archivo siempre tiene los datos en las mismas posiciones</li>
                                <li>Usa <em>headers</em> si las columnas pueden cambiar de orden pero tienen nombres consistentes</li>
                            </ul>
                        </li>
                        <li><strong>Resultado:</strong> El archivo final ser√° un Excel (.xlsx) listo para usar</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Transformaciones del Sistema -->
        <div class="user-manual-section">
            <div class="manual-header" onclick="toggleTransformations()">
                <h3>üîß Transformaciones del Sistema</h3>
                <span class="toggle-icon" id="transformationsToggleIcon">‚ñº</span>
            </div>
            <div class="manual-content" id="transformationsContent">
                
                <div class="transformation-intro">
                    <p><strong>Esta secci√≥n explica exactamente qu√© modificaciones aplicar√° el sistema al archivo CSV</strong></p>
                    <p>Revisa estas transformaciones para entender c√≥mo se procesar√° tu archivo CSV:</p>
                </div>

                <div class="transformation-section">
                    <h4>üìè Conversi√≥n de Medidas (Pies a Pulgadas)</h4>
                    <div class="transformation-details">
                        <p><strong>¬øCu√°ndo se aplica?</strong> Solo cuando tienes activada la opci√≥n "Convertir pies (ft) a pulgadas (in)"</p>
                        <p><strong>¬øQu√© campos afecta?</strong> √önicamente las columnas de dimensiones: <em>Length, Width, Height</em> (Largo, Ancho, Alto)</p>
                        <p><strong>¬øQu√© busca?</strong> Valores que contengan:</p>
                        <ul>
                            <li><code>"20ft"</code> o <code>"20 ft"</code> ‚Üí Se convierte en <code>"240 in"</code></li>
                            <li><code>"8.5 ft"</code> ‚Üí Se convierte en <code>"102 in"</code></li>
                            <li><code>"6'"</code> ‚Üí Se convierte en <code>"72 in"</code></li>
                            <li><code>"15"</code> (sin unidad) ‚Üí Se asume que son pies y se convierte en <code>"180 in"</code></li>
                        </ul>
                        <p><strong>¬øQu√© NO se toca?</strong> Valores que ya contengan "in" (pulgadas) se mantienen sin cambios</p>
                    </div>
                </div>

                <div class="transformation-section">
                    <h4>üñºÔ∏è Procesamiento de Fotos</h4>
                    <div class="transformation-details">
                        <p><strong>¬øQu√© hace?</strong> Toma una celda con m√∫ltiples URLs de fotos y las separa en columnas individuales</p>
                        <p><strong>Ejemplo de transformaci√≥n:</strong></p>
                        <div class="example-box">
                            <p><strong>Antes:</strong><br>
                            Columna "Images": <code>foto1.jpg, foto2.jpg, foto3.jpg</code></p>
                            <p><strong>Despu√©s:</strong><br>
                            Photo 1: <code>foto1.jpg</code><br>
                            Photo 2: <code>foto2.jpg</code><br>
                            Photo 3: <code>foto3.jpg</code></p>
                        </div>
                        <p><strong>¬øC√≥mo funciona?</strong> Busca comas para separar las URLs y elimina espacios extra</p>
                        <p><strong>Columnas creadas:</strong> Se crean autom√°ticamente tantas columnas "Photo X" como fotos tengas</p>
                    </div>
                </div>

                <div class="transformation-section">
                    <h4>üßπ Limpieza de Descripciones</h4>
                    <div class="transformation-details">
                        <p><strong>¬øQu√© campos afecta?</strong> Solo la columna "Description"</p>
                        <p><strong>¬øQu√© elimina?</strong> √önicamente los caracteres <code>#</code> y <code>*</code></p>
                        <p><strong>Ejemplo:</strong></p>
                        <div class="example-box">
                            <p><strong>Antes:</strong> <code>Trailer #123 *Nuevo* con caracter√≠sticas especiales</code></p>
                            <p><strong>Despu√©s:</strong> <code>Trailer 123 Nuevo con caracter√≠sticas especiales</code></p>
                        </div>
                        <p><strong>¬øQu√© NO se toca?</strong> Todo lo dem√°s se mantiene intacto (espacios, otros s√≠mbolos, may√∫sculas/min√∫sculas)</p>
                    </div>
                </div>

                <div class="transformation-section">
                    <h4>‚öñÔ∏è Eliminaci√≥n de Valores Cero en Pesos</h4>
                    <div class="transformation-details">
                        <p><strong>¬øQu√© campos afecta?</strong> Solo las columnas de peso: <em>GVWR</em> y <em>Payload Capacity</em></p>
                        <p><strong>¬øQu√© hace?</strong> Si encuentra un valor de 0 (cero), lo deja completamente vac√≠o</p>
                        <p><strong>¬øPor qu√©?</strong> Los ceros en pesos suelen ser datos faltantes, no pesos reales de 0 libras</p>
                        <p><strong>Ejemplo:</strong></p>
                        <div class="example-box">
                            <p><strong>Antes:</strong> <code>0</code>, <code>0.0</code>, <code>0 lbs</code></p>
                            <p><strong>Despu√©s:</strong> <em>(celda vac√≠a)</em></p>
                        </div>
                        <p><strong>¬øQu√© NO se toca?</strong> Valores mayores a cero se mantienen tal como est√°n</p>
                    </div>
                </div>

                <div class="transformation-section">
                    <h4>üìä Mapeo de Columnas</h4>
                    <div class="transformation-details">
                        <p><strong>¬øQu√© hace?</strong> Reorganiza tu informaci√≥n seg√∫n el template est√°ndar</p>
                        <p><strong>Mapeo principal:</strong></p>
                        <table class="mapping-table">
                            <thead>
                                <tr>
                                    <th>Tu archivo puede tener</th>
                                    <th>Se convierte en</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td>Stock #, Stock Number</td><td>Unique ID + Stock Number</td></tr>
                                <tr><td>Category</td><td>Class</td></tr>
                                <tr><td>Manufacturer</td><td>Make</td></tr>
                                <tr><td>Model</td><td>Model</td></tr>
                                <tr><td>Year</td><td>Year</td></tr>
                                <tr><td>VIN#</td><td>VIN/Serial Number</td></tr>
                                <tr><td>Condition</td><td>New/Used</td></tr>
                                <tr><td>Description</td><td>Description (limpia)</td></tr>
                                <tr><td>Color</td><td>Primary Color</td></tr>
                                <tr><td>Price</td><td>Price ($)</td></tr>
                                <tr><td>Length/Width/Height</td><td>Length/Width/Height (convertidas)</td></tr>
                                <tr><td>GVWR (lbs)</td><td>GVWR (sin ceros)</td></tr>
                                <tr><td>Payload Capacity (lbs)</td><td>Payload Capacity (sin ceros)</td></tr>
                                <tr><td>Images</td><td>Photo 1, Photo 2, Photo 3...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="transformation-section">
                    <h4>üîÑ Datos que NO se modifican</h4>
                    <div class="transformation-details">
                        <p><strong>El sistema respeta completamente:</strong></p>
                        <ul>
                            <li><strong>May√∫sculas y min√∫sculas</strong> (excepto en descripciones donde solo quita # y *)</li>
                            <li><strong>Espacios y formato de texto</strong></li>
                            <li><strong>N√∫meros que no sean precios o medidas</strong></li>
                            <li><strong>Fechas y otros formatos especiales</strong></li>
                            <li><strong>Celdas vac√≠as</strong> (se mantienen vac√≠as)</li>
                            <li><strong>Datos que no coincidan con las columnas mapeadas</strong></li>
                        </ul>
                    </div>
                </div>

                <div class="transformation-warning">
                    <h4>‚ö†Ô∏è Importante</h4>
                    <p><strong>Estas transformaciones son autom√°ticas y se aplican en el momento del procesamiento.</strong></p>
                    <p>Si alguna transformaci√≥n no es adecuada para tus datos, puedes:</p>
                    <ul>
                        <li>Desactivar la conversi√≥n de pies a pulgadas</li>
                        <li>Ajustar tu archivo CSV antes de procesarlo</li>
                        <li>Editar manualmente el archivo final</li>
                    </ul>
                </div>

            </div>
        </div>

        <br><br><br>
    </div>

    <!-- Include XLSX library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="app.js"></script>
</body>
</html>
